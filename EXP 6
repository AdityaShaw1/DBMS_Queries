SELECT E.ENAME, E.JOB, E.DEPTNO, D.DNAME
FROM EMPLOYEE E
JOIN DEPARTMENT D ON E.DEPTNO = D.DEPTNO
WHERE D.LOC = 'DALLAS';

SELECT E1.ENAME AS EmployeeName, E1.ENO AS EmployeeNo, 
       E2.ENAME AS ManagerName, E2.ENO AS ManagerNo
FROM EMPLOYEE E1
LEFT JOIN EMPLOYEE E2 ON E1.MGR = E2.ENO;

SELECT E1.ENAME AS EmployeeName, E1.ENO AS EmployeeNo, 
       NVL(E2.ENAME, 'No Manager') AS ManagerName, NVL(E2.ENO, 'No Manager No') AS ManagerNo
FROM EMPLOYEE E1
LEFT JOIN EMPLOYEE E2 ON E1.MGR = E2.ENO;

SELECT E1.ENAME AS EmployeeName
FROM EMPLOYEE E1
JOIN EMPLOYEE E2 ON E1.DEPTNO = E2.DEPTNO
WHERE E2.ENO = :GivenEmployeeNo
  AND E1.ENO != E2.ENO;

SELECT E.ENAME, E.JOB, D.DNAME, E.SAL, S.GRADE
FROM EMPLOYEE E
JOIN DEPARTMENT D ON E.DEPTNO = D.DEPTNO
JOIN SALGRADE S ON E.SAL BETWEEN S.LOSAL AND S.HISAL;

SELECT E.ENAME, E.HIREDATE
FROM EMPLOYEE E
WHERE E.HIREDATE > (SELECT HIREDATE FROM EMPLOYEE WHERE ENAME = 'Blake');

SELECT E1.ENAME AS EmployeeName, E1.HIREDATE AS EmployeeHireDate,
       E2.ENAME AS ManagerName, E2.HIREDATE AS ManagerHireDate
FROM EMPLOYEE E1
JOIN EMPLOYEE E2 ON E1.MGR = E2.ENO
WHERE E1.HIREDATE < E2.HIREDATE;

SELECT MAX(SAL) AS SecondHighestSalary
FROM EMPLOYEE
WHERE SAL < (SELECT MAX(SAL) FROM EMPLOYEE);

SELECT SAL
FROM (
    SELECT SAL, DENSE_RANK() OVER (ORDER BY SAL DESC) AS RANK
    FROM EMPLOYEE
) 
WHERE RANK = 5;
