SELECT *
FROM EMPLOYEE
WHERE COMM IS NULL;

SELECT ENAME, SAL + NVL(COMM, 0) AS Total_Salary
FROM EMPLOYEE;

SELECT ENAME, SAL * 1.20 AS Increased_Salary
FROM EMPLOYEE
WHERE JOB = 'Manager';

SELECT 'Mr. ' || ENAME || '’s total earning is ' || (SAL + NVL(COMM, 0)) AS Salesman_Earnings
FROM EMPLOYEE
WHERE JOB = 'Salesman';

SELECT 'Today’s date is ' || TO_CHAR(SYSDATE, 'DDth Month, YYYY') AS Today_Date
FROM DUAL;

SELECT MIN(SAL) AS Min_Salary, MAX(SAL) AS Max_Salary
FROM EMPLOYEE;

SELECT E.*, D.DNAME
FROM EMPLOYEE E
JOIN DEPARTMENT D ON E.DEPTNO = D.DEPTNO
ORDER BY E.HIREDATE ASC;

SELECT D.DNAME, MIN(E.SAL) AS Min_Salary, MAX(E.SAL) AS Max_Salary, AVG(E.SAL) AS Avg_Salary, SUM(E.SAL) AS Total_Salary
FROM EMPLOYEE E
JOIN DEPARTMENT D ON E.DEPTNO = D.DEPTNO
GROUP BY D.DNAME
ORDER BY D.DNAME ASC;

SELECT D.DNAME, COUNT(*) AS Num_Employees
FROM EMPLOYEE E
JOIN DEPARTMENT D ON E.DEPTNO = D.DEPTNO
GROUP BY D.DNAME
HAVING COUNT(*) >= 4;

SELECT ENAME
FROM EMPLOYEE
WHERE SAL > (SELECT AVG(SAL) 
             FROM EMPLOYEE 
             WHERE LENGTH(ENAME) = 5);

SELECT *
FROM EMPLOYEE
WHERE DEPTNO IN (SELECT DEPTNO 
                 FROM DEPARTMENT 
                 WHERE DNAME IN ('SALES', 'HRD'));

SELECT LOC
FROM DEPARTMENT
WHERE DEPTNO = (SELECT DEPTNO 
                FROM EMPLOYEE 
                WHERE ENAME = 'Wong');

ALTER TABLE EMPLOYEE
ADD CONSTRAINT FK_DEPTNO FOREIGN KEY (DEPTNO)
REFERENCES DEPARTMENT(DEPTNO)
ON DELETE CASCADE;

-- Deleting the RESEARCH department
DELETE FROM DEPARTMENT
WHERE DNAME = 'RESEARCH';

SELECT *
FROM EMPLOYEE
ORDER BY SAL + NVL(COMM, 0) DESC
FETCH FIRST 3 ROWS ONLY;

SELECT E1.ENAME AS Employee, NVL(E2.ENAME, 'No Manager') AS Manager
FROM EMPLOYEE E1
LEFT JOIN EMPLOYEE E2 ON E1.MGR = E2.ENO;



